var qrcode=function(){"use strict";function e(e,t){this.count=e,this.dataCodewords=t,this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("DataCodewords",function(){return this.dataCodewords})}function t(e,t,i){this.ecCodewordsPerBlock=e,this.ecBlocks=i?[t,i]:Array(t),this.__defineGetter__("ECCodewordsPerBlock",function(){return this.ecCodewordsPerBlock}),this.__defineGetter__("TotalECCodewords",function(){return this.ecCodewordsPerBlock*this.NumBlocks}),this.__defineGetter__("NumBlocks",function(){for(var e=0,t=0;t<this.ecBlocks.length;t++)e+=this.ecBlocks[t].length;return e}),this.getECBlocks=function(){return this.ecBlocks}}function i(e,t,i,n,r,s){for(this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=[i,n,r,s],e=0,t=i.ECCodewordsPerBlock,i=i.getECBlocks(),n=0;n<i.length;n++)e+=(r=i[n]).Count*(r.DataCodewords+t);this.totalCodewords=e,this.__defineGetter__("VersionNumber",function(){return this.versionNumber}),this.__defineGetter__("AlignmentPatternCenters",function(){return this.alignmentPatternCenters}),this.__defineGetter__("TotalCodewords",function(){return this.totalCodewords}),this.__defineGetter__("DimensionForVersion",function(){return 17+4*this.versionNumber}),this.buildFunctionPattern=function(){var e=this.DimensionForVersion,t=new h(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var i=this.alignmentPatternCenters.length,n=0;n<i;n++)for(var r=this.alignmentPatternCenters[n]-2,s=0;s<i;s++)0==n&&(0==s||s==i-1)||n==i-1&&0==s||t.setRegion(this.alignmentPatternCenters[s]-2,r,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),6<this.versionNumber&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t},this.getECBlocksForLevel=function(e){return this.ecBlocks[e.ordinal()]}}function n(e,t,i,r,s,o,a,h,_){this.a11=e,this.a12=r,this.a13=a,this.a21=t,this.a22=s,this.a23=h,this.a31=i,this.a32=o,this.a33=_,this.transformPoints1=function(e){for(var t=e.length,i=this.a11,n=this.a12,r=this.a13,s=this.a21,o=this.a22,a=this.a23,h=this.a31,_=this.a32,f=this.a33,w=0;w<t;w+=2){var u=e[w],d=e[w+1],l=r*u+a*d+f;e[w]=(i*u+s*d+h)/l,e[w+1]=(n*u+o*d+_)/l}},this.transformPoints2=function(e,t){for(var i=e.length,n=0;n<i;n++){var r=e[n],s=t[n],o=this.a13*r+this.a23*s+this.a33;e[n]=(this.a11*r+this.a21*s+this.a31)/o,t[n]=(this.a12*r+this.a22*s+this.a32)/o}},this.buildAdjoint=function(){return new n(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},this.times=function(e){return new n(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}function r(e,t){this.bits=e,this.points=t}function s(e){this.image=e,this.resultPointCallback=null,this.sizeOfBlackWhiteBlackRun=function(e,t,i,n){var r=Math.abs(n-t)>Math.abs(i-e);if(r){var s=e;e=t,t=s,s=i,i=n,n=s}for(var o=Math.abs(i-e),a=Math.abs(n-t),h=-o>>1,_=t<n?1:-1,f=e<i?1:-1,w=0,u=e,s=t;u!=i;u+=f){var d=r?s:u,l=r?u:s;if(1==w?this.image[d+l*D.width]&&w++:this.image[d+l*D.width]||w++,3==w)return Math.sqrt((n=u-e)*n+(t=s-t)*t);if(0<(h+=a)){if(s==n)break;s+=_,h-=o}}return Math.sqrt((e=i-e)*e+(t=n-t)*t)},this.sizeOfBlackWhiteBlackRunBothWays=function(e,t,i,n){var r=this.sizeOfBlackWhiteBlackRun(e,t,i,n),s=1;return 0>(i=e-(i-e))?(s=e/(e-i),i=0):i>=D.width&&(s=(D.width-1-e)/(i-e),i=D.width-1),n=Math.floor(t-(n-t)*s),s=1,0>n?(s=t/(t-n),n=0):n>=D.height&&(s=(D.height-1-t)/(n-t),n=D.height-1),i=Math.floor(e+(i-e)*s),(r+=this.sizeOfBlackWhiteBlackRun(e,t,i,n))-1},this.calculateModuleSizeOneWay=function(e,t){var i=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y)),n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y));return isNaN(i)?n/7:isNaN(n)?i/7:(i+n)/14},this.calculateModuleSize=function(e,t,i){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,i))/2},this.distance=function(e,t){var i=e.X-t.X,n=e.Y-t.Y;return Math.sqrt(i*i+n*n)},this.computeDimension=function(e,t,i,n){switch(3&(e=((t=Math.round(this.distance(e,t)/n))+(e=Math.round(this.distance(e,i)/n))>>1)+7)){case 0:e++;break;case 2:e--;break;case 3:throw"Error"}return e},this.findAlignmentInRegion=function(e,t,i,n){var r=Math.max(0,t-(n=Math.floor(n*e)));if((t=Math.min(D.width-1,t+n))-r<3*e)throw"Error";var s=Math.max(0,i-n);return new m(this.image,r,s,t-r,Math.min(D.height-1,i+n)-s,e,this.resultPointCallback).find()},this.createTransform=function(e,t,i,r,s){if(s-=3.5,null!=r){var o,a=r.X;r=r.Y;var h=o=s-3}else a=t.X-e.X+i.X,r=t.Y-e.Y+i.Y,h=o=s;return n.quadrilateralToQuadrilateral(3.5,3.5,s,3.5,h,o,3.5,s,e.X,e.Y,t.X,t.Y,a,r,i.X,i.Y)},this.sampleGrid=function(e,t,i){return b.sampleGrid3(e,i,t)},this.processFinderPatternInfo=function(e){var t=e.TopLeft,n=e.TopRight;e=e.BottomLeft;var s=this.calculateModuleSize(t,n,e);if(1>s)throw"Error";var o=this.computeDimension(t,n,e,s),a=i.getProvisionalVersionForDimension(o),h=a.DimensionForVersion-7,_=null;if(0<a.AlignmentPatternCenters.length)for(a=1-3/h,_=Math.floor(t.X+a*(n.X-t.X+e.X-t.X)),a=Math.floor(t.Y+a*(n.Y-t.Y+e.Y-t.Y));;){_=this.findAlignmentInRegion(s,_,a,4);break}return s=this.createTransform(t,n,e,_,o),o=this.sampleGrid(this.image,s,o),new r(o,null==_?[e,t,n]:[e,t,n,_])},this.detect=function(){var e=(new $).findFinderPattern(this.image);return this.processFinderPatternInfo(e)}}function o(e){this.errorCorrectionLevel=a.forBits(e>>3&3),this.dataMask=7&e,this.__defineGetter__("ErrorCorrectionLevel",function(){return this.errorCorrectionLevel}),this.__defineGetter__("DataMask",function(){return this.dataMask}),this.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|this.dataMask},this.Equals=function(e){return this.errorCorrectionLevel==e.errorCorrectionLevel&&this.dataMask==e.dataMask}}function a(e,t,i){this.ordinal_Renamed_Field=e,this.bits=t,this.name=i,this.__defineGetter__("Bits",function(){return this.bits}),this.__defineGetter__("Name",function(){return this.name}),this.ordinal=function(){return this.ordinal_Renamed_Field}}function h(e,t){if(t||(t=e),1>e||1>t)throw"Both dimensions must be greater than 0";this.width=e,this.height=t;var i=e>>5;for(0!=(31&e)&&i++,this.rowSize=i,this.bits=Array(i*t),i=0;i<this.bits.length;i++)this.bits[i]=0;this.__defineGetter__("Width",function(){return this.width}),this.__defineGetter__("Height",function(){return this.height}),this.__defineGetter__("Dimension",function(){if(this.width!=this.height)throw"Can't call getDimension() on a non-square matrix";return this.width}),this.get_Renamed=function(e,t){return 0!=(1&d(this.bits[t*this.rowSize+(e>>5)],31&e))},this.set_Renamed=function(e,t){this.bits[t*this.rowSize+(e>>5)]|=1<<(31&e)},this.flip=function(e,t){this.bits[t*this.rowSize+(e>>5)]^=1<<(31&e)},this.clear=function(){for(var e=this.bits.length,t=0;t<e;t++)this.bits[t]=0},this.setRegion=function(e,t,i,n){if(0>t||0>e)throw"Left and top must be nonnegative";if(1>n||1>i)throw"Height and width must be at least 1";if(i=e+i,(n=t+n)>this.height||i>this.width)throw"The region must fit inside the matrix";for(;t<n;t++)for(var r=t*this.rowSize,s=e;s<i;s++)this.bits[r+(s>>5)]|=1<<(31&s)}}function _(e,t){this.numDataCodewords=e,this.codewords=t,this.__defineGetter__("NumDataCodewords",function(){return this.numDataCodewords}),this.__defineGetter__("Codewords",function(){return this.codewords})}function f(e){var t=e.Dimension;if(21>t||1!=(3&t))throw"Error BitMatrixParser";this.bitMatrix=e,this.parsedFormatInfo=this.parsedVersion=null,this.copyBit=function(e,t,i){return this.bitMatrix.get_Renamed(e,t)?i<<1|1:i<<1},this.readFormatInformation=function(){if(null!=this.parsedFormatInfo)return this.parsedFormatInfo;for(var e=0,t=0;6>t;t++)e=this.copyBit(t,8,e);for(t=5,e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);0<=t;t--)e=this.copyBit(8,t,e);if(this.parsedFormatInfo=o.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;for(var i=this.bitMatrix.Dimension,e=0,n=i-8,t=i-1;t>=n;t--)e=this.copyBit(t,8,e);for(t=i-7;t<i;t++)e=this.copyBit(8,t,e);if(this.parsedFormatInfo=o.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;throw"Error readFormatInformation"},this.readVersion=function(){if(null!=this.parsedVersion)return this.parsedVersion;var e=this.bitMatrix.Dimension,t=e-17>>2;if(6>=t)return i.getVersionForNumber(t);for(var t=0,n=e-11,r=5;0<=r;r--)for(var s=e-9;s>=n;s--)t=this.copyBit(s,r,t);if(this.parsedVersion=i.decodeVersionInformation(t),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;for(s=5,t=0;0<=s;s--)for(r=e-9;r>=n;r--)t=this.copyBit(s,r,t);if(this.parsedVersion=i.decodeVersionInformation(t),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;throw"Error readVersion"},this.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),i=M.forReference(e.DataMask),e=this.bitMatrix.Dimension;i.unmaskBitMatrix(this.bitMatrix,e);for(var i=t.buildFunctionPattern(),n=!0,r=Array(t.TotalCodewords),s=0,o=0,a=0,h=e-1;0<h;h-=2){6==h&&h--;for(var _=0;_<e;_++)for(var f=n?e-1-_:_,w=0;2>w;w++)i.get_Renamed(h-w,f)||(a++,o<<=1,this.bitMatrix.get_Renamed(h-w,f)&&(o|=1),8==a&&(r[s++]=o,o=a=0));n^=1}if(s!=t.TotalCodewords)throw"Error readCodewords";return r}}function w(e,t){if(null==t||0==t.length)throw"System.ArgumentException";this.field=e;var i=t.length;if(1<i&&0==t[0]){for(var n=1;n<i&&0==t[n];)n++;if(n==i)this.coefficients=e.Zero.coefficients;else{for(this.coefficients=Array(i-n),i=0;i<this.coefficients.length;i++)this.coefficients[i]=0;for(i=0;i<this.coefficients.length;i++)this.coefficients[i]=t[n+i]}}else this.coefficients=t;this.__defineGetter__("Zero",function(){return 0==this.coefficients[0]}),this.__defineGetter__("Degree",function(){return this.coefficients.length-1}),this.__defineGetter__("Coefficients",function(){return this.coefficients}),this.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},this.evaluateAt=function(e){if(0==e)return this.getCoefficient(0);var t=this.coefficients.length;if(1==e){for(var i=e=0;i<t;i++)e=u.addOrSubtract(e,this.coefficients[i]);return e}for(var n=this.coefficients[0],i=1;i<t;i++)n=u.addOrSubtract(this.field.multiply(e,n),this.coefficients[i]);return n},this.addOrSubtract=function(t){if(this.field!=t.field)throw"GF256Polys do not have same GF256 field";if(this.Zero)return t;if(t.Zero)return this;var i=this.coefficients;if(t=t.coefficients,i.length>t.length){var n=i,i=t;t=n}for(var n=Array(t.length),r=t.length-i.length,s=0;s<r;s++)n[s]=t[s];for(s=r;s<t.length;s++)n[s]=u.addOrSubtract(i[s-r],t[s]);return new w(e,n)},this.multiply1=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(this.Zero||e.Zero)return this.field.Zero;var t=this.coefficients,i=t.length;e=e.coefficients;for(var n=e.length,r=Array(i+n-1),s=0;s<i;s++)for(var o=t[s],a=0;a<n;a++)r[s+a]=u.addOrSubtract(r[s+a],this.field.multiply(o,e[a]));return new w(this.field,r)},this.multiply2=function(e){if(0==e)return this.field.Zero;if(1==e)return this;for(var t=this.coefficients.length,i=Array(t),n=0;n<t;n++)i[n]=this.field.multiply(this.coefficients[n],e);return new w(this.field,i)},this.multiplyByMonomial=function(e,t){if(0>e)throw"System.ArgumentException";if(0==t)return this.field.Zero;for(var i=this.coefficients.length,n=Array(i+e),r=0;r<n.length;r++)n[r]=0;for(r=0;r<i;r++)n[r]=this.field.multiply(this.coefficients[r],t);return new w(this.field,n)},this.divide=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(e.Zero)throw"Divide by 0";for(var t=this.field.Zero,i=this,n=e.getCoefficient(e.Degree),n=this.field.inverse(n);i.Degree>=e.Degree&&!i.Zero;)var r=i.Degree-e.Degree,s=this.field.multiply(i.getCoefficient(i.Degree),n),o=e.multiplyByMonomial(r,s),r=this.field.buildMonomial(r,s),t=t.addOrSubtract(r),i=i.addOrSubtract(o);return[t,i]}}function u(e){this.expTable=Array(256),this.logTable=Array(256);for(var t=1,i=0;256>i;i++)this.expTable[i]=t,256<=(t<<=1)&&(t^=e);for(i=0;255>i;i++)this.logTable[this.expTable[i]]=i;(e=[,])[0]=0,this.zero=new w(this,Array(e)),(e=[,])[0]=1,this.one=new w(this,Array(e)),this.__defineGetter__("Zero",function(){return this.zero}),this.__defineGetter__("One",function(){return this.one}),this.buildMonomial=function(e,t){if(0>e)throw"System.ArgumentException";if(0==t)return this.zero;for(var i=Array(e+1),n=0;n<i.length;n++)i[n]=0;return i[0]=t,new w(this,i)},this.exp=function(e){return this.expTable[e]},this.log=function(e){if(0==e)throw"System.ArgumentException";return this.logTable[e]},this.inverse=function(e){if(0==e)throw"System.ArithmeticException";return this.expTable[255-this.logTable[e]]},this.multiply=function(e,t){return 0==e||0==t?0:1==e?t:1==t?e:this.expTable[(this.logTable[e]+this.logTable[t])%255]}}function d(e,t){return 0<=e?e>>t:(e>>t)+(2<<~t)}function l(e,t,i){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=i,this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return this.x}),this.__defineGetter__("Y",function(){return this.y}),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,i){return!!(Math.abs(t-this.y)<=e&&Math.abs(i-this.x)<=e)&&(1>=(e=Math.abs(e-this.estimatedModuleSize))||1>=e/this.estimatedModuleSize)}}function c(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2],this.__defineGetter__("BottomLeft",function(){return this.bottomLeft}),this.__defineGetter__("TopLeft",function(){return this.topLeft}),this.__defineGetter__("TopRight",function(){return this.topRight})}function $(){this.image=null,this.possibleCenters=[],this.hasSkipped=!1,this.crossCheckStateCount=[0,0,0,0,0],this.resultPointCallback=null,this.__defineGetter__("CrossCheckStateCount",function(){return this.crossCheckStateCount[0]=0,this.crossCheckStateCount[1]=0,this.crossCheckStateCount[2]=0,this.crossCheckStateCount[3]=0,this.crossCheckStateCount[4]=0,this.crossCheckStateCount}),this.foundPatternCross=function(e){for(var t=0,i=0;5>i;i++){var n=e[i];if(0==n)return!1;t+=n}return!(7>t)&&(i=Math.floor((t=Math.floor((t<<I)/7))/2),Math.abs(t-(e[0]<<I))<i&&Math.abs(t-(e[1]<<I))<i&&Math.abs(3*t-(e[2]<<I))<3*i&&Math.abs(t-(e[3]<<I))<i&&Math.abs(t-(e[4]<<I))<i)},this.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2},this.crossCheckVertical=function(e,t,i,n){for(var r=this.image,s=D.height,o=this.CrossCheckStateCount,a=e;0<=a&&r[t+a*D.width];)o[2]++,a--;if(0>a)return NaN;for(;0<=a&&!r[t+a*D.width]&&o[1]<=i;)o[1]++,a--;if(0>a||o[1]>i)return NaN;for(;0<=a&&r[t+a*D.width]&&o[0]<=i;)o[0]++,a--;if(o[0]>i)return NaN;for(a=e+1;a<s&&r[t+a*D.width];)o[2]++,a++;if(a==s)return NaN;for(;a<s&&!r[t+a*D.width]&&o[3]<i;)o[3]++,a++;if(a==s||o[3]>=i)return NaN;for(;a<s&&r[t+a*D.width]&&o[4]<i;)o[4]++,a++;return o[4]>=i||5*Math.abs(o[0]+o[1]+o[2]+o[3]+o[4]-n)>=2*n?NaN:this.foundPatternCross(o)?this.centerFromEnd(o,a):NaN},this.crossCheckHorizontal=function(e,t,i,n){for(var r=this.image,s=D.width,o=this.CrossCheckStateCount,a=e;0<=a&&r[a+t*D.width];)o[2]++,a--;if(0>a)return NaN;for(;0<=a&&!r[a+t*D.width]&&o[1]<=i;)o[1]++,a--;if(0>a||o[1]>i)return NaN;for(;0<=a&&r[a+t*D.width]&&o[0]<=i;)o[0]++,a--;if(o[0]>i)return NaN;for(a=e+1;a<s&&r[a+t*D.width];)o[2]++,a++;if(a==s)return NaN;for(;a<s&&!r[a+t*D.width]&&o[3]<i;)o[3]++,a++;if(a==s||o[3]>=i)return NaN;for(;a<s&&r[a+t*D.width]&&o[4]<i;)o[4]++,a++;return o[4]>=i||5*Math.abs(o[0]+o[1]+o[2]+o[3]+o[4]-n)>=n?NaN:this.foundPatternCross(o)?this.centerFromEnd(o,a):NaN},this.handlePossibleCenter=function(e,t,i){var n=e[0]+e[1]+e[2]+e[3]+e[4];if(i=this.centerFromEnd(e,i),!isNaN(t=this.crossCheckVertical(t,Math.floor(i),e[2],n))&&!isNaN(i=this.crossCheckHorizontal(Math.floor(i),Math.floor(t),e[2],n))){e=n/7;for(var n=!1,r=this.possibleCenters.length,s=0;s<r;s++){var o=this.possibleCenters[s];if(o.aboutEquals(e,t,i)){o.incrementCount(),n=!0;break}}return n||(i=new l(i,t,e),this.possibleCenters.push(i),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(i)),!0}return!1},this.selectBestPatterns=function(){var e=this.possibleCenters.length;if(3>e)throw"Couldn't find enough finder patterns (found "+e+")";if(3<e){for(var t=0,i=0,n=0;n<e;n++)var r=this.possibleCenters[n].EstimatedModuleSize,t=t+r,i=i+r*r;var s=t/e;for(this.possibleCenters.sort(function(e,t){var i=Math.abs(t.EstimatedModuleSize-s),n=Math.abs(e.EstimatedModuleSize-s);return i<n?-1:i==n?0:1}),e=Math.max(.2*s,Math.sqrt(i/e-s*s)),n=this.possibleCenters.length-1;0<=n;n--)Math.abs(this.possibleCenters[n].EstimatedModuleSize-s)>e&&this.possibleCenters.splice(n,1)}return 3<this.possibleCenters.length&&this.possibleCenters.sort(function(e,t){return e.count>t.count?-1:e.count<t.count?1:0}),[this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2]]},this.findRowSkip=function(){var e=this.possibleCenters.length;if(1>=e)return 0;for(var t=null,i=0;i<e;i++){var n=this.possibleCenters[i];if(n.Count>=R){if(null!=t)return this.hasSkipped=!0,Math.floor((Math.abs(t.X-n.X)-Math.abs(t.Y-n.Y))/2);t=n}}return 0},this.haveMultiplyConfirmedCenters=function(){for(var e,t=0,i=0,n=this.possibleCenters.length,r=0;r<n;r++)(e=this.possibleCenters[r]).Count>=R&&(t++,i+=e.EstimatedModuleSize);if(3>t)return!1;for(var t=i/n,s=0,r=0;r<n;r++)s+=Math.abs((e=this.possibleCenters[r]).EstimatedModuleSize-t);return s<=.05*i},this.findFinderPattern=function(e){this.image=e;var t,i=D.height,n=D.width,r=Math.floor(3*i/(4*F));r<x&&(r=x);for(var s=!1,o=[,,,,,],a=r-1;a<i&&!s;a+=r){o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var h=t=o[4]=0;h<n;h++)if(e[h+a*D.width])1==(1&t)&&t++,o[t]++;else if(0==(1&t)){if(4==t){if(this.foundPatternCross(o)){if(t=this.handlePossibleCenter(o,a,h))r=2,this.hasSkipped?s=this.haveMultiplyConfirmedCenters():(t=this.findRowSkip())>o[2]&&(a+=t-o[2]-r,h=n-1);else{do h++;while(h<n&&!e[h+a*D.width]);h--}t=0,o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0}else o[0]=o[2],o[1]=o[3],o[2]=o[4],o[3]=1,o[4]=0,t=3}else o[++t]++}else o[t]++;this.foundPatternCross(o)&&(t=this.handlePossibleCenter(o,a,n))&&(r=o[0],this.hasSkipped&&(s=this.haveMultiplyConfirmedCenters()))}return e=this.selectBestPatterns(),D.orderBestPatterns(e),new c(e)}}function g(e,t,i){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=i,this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return Math.floor(this.x)}),this.__defineGetter__("Y",function(){return Math.floor(this.y)}),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,i){return!!(Math.abs(t-this.y)<=e&&Math.abs(i-this.x)<=e)&&(1>=(e=Math.abs(e-this.estimatedModuleSize))||1>=e/this.estimatedModuleSize)}}function m(e,t,i,n,r,s,o){this.image=e,this.possibleCenters=[],this.startX=t,this.startY=i,this.width=n,this.height=r,this.moduleSize=s,this.crossCheckStateCount=[0,0,0],this.resultPointCallback=o,this.centerFromEnd=function(e,t){return t-e[2]-e[1]/2},this.foundPatternCross=function(e){for(var t=this.moduleSize,i=t/2,n=0;3>n;n++)if(Math.abs(t-e[n])>=i)return!1;return!0},this.crossCheckVertical=function(e,t,i,n){var r=this.image,s=D.height,o=this.crossCheckStateCount;o[0]=0,o[1]=0,o[2]=0;for(var a=e;0<=a&&r[t+a*D.width]&&o[1]<=i;)o[1]++,a--;if(0>a||o[1]>i)return NaN;for(;0<=a&&!r[t+a*D.width]&&o[0]<=i;)o[0]++,a--;if(o[0]>i)return NaN;for(a=e+1;a<s&&r[t+a*D.width]&&o[1]<=i;)o[1]++,a++;if(a==s||o[1]>i)return NaN;for(;a<s&&!r[t+a*D.width]&&o[2]<=i;)o[2]++,a++;return o[2]>i||5*Math.abs(o[0]+o[1]+o[2]-n)>=2*n?NaN:this.foundPatternCross(o)?this.centerFromEnd(o,a):NaN},this.handlePossibleCenter=function(e,t,i){var n=e[0]+e[1]+e[2];if(i=this.centerFromEnd(e,i),!isNaN(t=this.crossCheckVertical(t,Math.floor(i),2*e[1],n))){e=(e[0]+e[1]+e[2])/3;for(var n=this.possibleCenters.length,r=0;r<n;r++)if(this.possibleCenters[r].aboutEquals(e,t,i))return new g(i,t,e);i=new g(i,t,e),this.possibleCenters.push(i),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(i)}return null},this.find=function(){for(var t,r=this.startX,s=this.height,o=r+n,a=i+(s>>1),h=[0,0,0],_=0;_<s;_++){var f=a+(0==(1&_)?_+1>>1:-(_+1>>1));h[0]=0,h[1]=0,h[2]=0;for(var w=r;w<o&&!e[w+D.width*f];)w++;for(t=0;w<o;){if(e[w+f*D.width]){if(1==t)h[t]++;else if(2==t){if(this.foundPatternCross(h)&&null!=(t=this.handlePossibleCenter(h,f,w)))return t;h[0]=h[2],h[1]=1,h[2]=0,t=1}else h[++t]++}else 1==t&&t++,h[t]++;w++}if(this.foundPatternCross(h)&&null!=(t=this.handlePossibleCenter(h,f,o)))return t}if(0!=this.possibleCenters.length)return this.possibleCenters[0];throw"Couldn't find enough alignment patterns"}}function v(e,t,i){this.blockPointer=0,this.bitPointer=7,this.dataLength=0,this.blocks=e,this.numErrorCorrectionCode=i,9>=t?this.dataLengthMode=0:10<=t&&26>=t?this.dataLengthMode=1:27<=t&&40>=t&&(this.dataLengthMode=2),this.getNextBits=function(e){var t,i;if(e<this.bitPointer+1){var n=0;for(i=0;i<e;i++)n+=1<<i;return n<<=this.bitPointer-e+1,i=(this.blocks[this.blockPointer]&n)>>this.bitPointer-e+1,this.bitPointer-=e,i}if(e<this.bitPointer+1+8){for(i=t=0;i<this.bitPointer+1;i++)t+=1<<i;return i=(this.blocks[this.blockPointer]&t)<<e-(this.bitPointer+1),this.blockPointer++,i+=this.blocks[this.blockPointer]>>8-(e-(this.bitPointer+1)),this.bitPointer-=e%8,0>this.bitPointer&&(this.bitPointer=8+this.bitPointer),i}if(e<this.bitPointer+1+16){for(i=n=t=0;i<this.bitPointer+1;i++)t+=1<<i;t=(this.blocks[this.blockPointer]&t)<<e-(this.bitPointer+1),this.blockPointer++;var r=this.blocks[this.blockPointer]<<e-(this.bitPointer+1+8);for(this.blockPointer++,i=0;i<e-(this.bitPointer+1+8);i++)n+=1<<i;return n<<=8-(e-(this.bitPointer+1+8)),i=(this.blocks[this.blockPointer]&n)>>8-(e-(this.bitPointer+1+8)),this.bitPointer-=(e-8)%8,0>this.bitPointer&&(this.bitPointer=8+this.bitPointer),t+r+i}return 0},this.NextMode=function(){return this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2?0:this.getNextBits(4)},this.getDataLength=function(e){for(var t=0;1!=e>>t;)t++;return this.getNextBits(D.sizeOfDataLengthInfo[this.dataLengthMode][t])},this.getRomanAndFigureString=function(e){var t="",i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:".split("");do if(1<e){var n=this.getNextBits(11),r=n%45,t=t+i[Math.floor(n/45)],t=t+i[r];e-=2}else 1==e&&(t+=i[n=this.getNextBits(6)],--e);while(0<e);return t},this.getFigureString=function(e){var t=0,i="";do 3<=e?(100>(t=this.getNextBits(10))&&(i+="0"),10>t&&(i+="0"),e-=3):2==e?(10>(t=this.getNextBits(7))&&(i+="0"),e-=2):1==e&&(t=this.getNextBits(4),--e),i+=t;while(0<e);return i},this.get8bitByteArray=function(e){var t=[];do{var i=this.getNextBits(8);t.push(i),e--}while(0<e);return t},this.getKanjiString=function(e){var t="";do{var i=this.getNextBits(13);t+=String.fromCharCode(40956>=(i=(i/192<<8)+i%192)+33088?i+33088:i+49472),e--}while(0<e);return t},this.parseECIValue=function(){var e=0,t=this.getNextBits(8);return 0==(128&t)&&(e=127&t),128==(192&t)&&(e=this.getNextBits(8),e|=(63&t)<<8),192==(224&t)&&(e=this.getNextBits(8),e|=(31&t)<<16),e},this.__defineGetter__("DataByte",function(){for(var e=[];;){var t=this.NextMode();if(0==t){if(0<e.length)break;throw"Empty data block"}if(1!=t&&2!=t&&4!=t&&8!=t&&7!=t)throw"Invalid mode: "+t+" in (block:"+this.blockPointer+" bit:"+this.bitPointer+")";if(7==t)this.parseECIValue();else{var i=this.getDataLength(t);if(1>i)throw"Invalid data length: "+i;switch(t){case 1:t=this.getFigureString(i);for(var i=Array(t.length),n=0;n<t.length;n++)i[n]=t.charCodeAt(n);e.push(i);break;case 2:for(n=0,t=this.getRomanAndFigureString(i),i=Array(t.length);n<t.length;n++)i[n]=t.charCodeAt(n);e.push(i);break;case 4:t=this.get8bitByteArray(i),e.push(t);break;case 8:t=this.getKanjiString(i),e.push(t)}}}return e})}var b={checkAndNudgePoints:function(e,t){for(var i,n,r=D.width,s=D.height,o=!0,a=0;a<t.length&&o;a+=2){if(n=Math.floor(t[a]),i=Math.floor(t[a+1]),-1>n||n>r||-1>i||i>s)throw"Error.checkAndNudgePoints ";o=!1,-1==n?(t[a]=0,o=!0):n==r&&(t[a]=r-1,o=!0),-1==i?(t[a+1]=0,o=!0):i==s&&(t[a+1]=s-1,o=!0)}for(o=!0,a=t.length-2;0<=a&&o;a-=2){if(n=Math.floor(t[a]),i=Math.floor(t[a+1]),-1>n||n>r||-1>i||i>s)throw"Error.checkAndNudgePoints ";o=!1,-1==n?(t[a]=0,o=!0):n==r&&(t[a]=r-1,o=!0),-1==i?(t[a+1]=0,o=!0):i==s&&(t[a+1]=s-1,o=!0)}},sampleGrid3:function(e,t,i){for(var n=new h(t),r=Array(t<<1),s=0;s<t;s++){for(var o=r.length,a=s+.5,_=0;_<o;_+=2)r[_]=(_>>1)+.5,r[_+1]=a;i.transformPoints1(r),b.checkAndNudgePoints(e,r);try{for(_=0;_<o;_+=2)e[Math.floor(r[_])+D.width*Math.floor(r[_+1])]&&n.set_Renamed(_>>1,s)}catch(f){throw"Error.checkAndNudgePoints"}}return n},sampleGridx:function(e,t,i,r,s,o,a,h,_,f,w,u,d,l,c,$,g,m){return i=n.quadrilateralToQuadrilateral(i,r,s,o,a,h,_,f,w,u,d,l,c,$,g,m),b.sampleGrid3(e,t,i)}};i.VERSION_DECODE_INFO=[31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017],i.VERSIONS=[new i(1,[],new t(7,new e(1,19)),new t(10,new e(1,16)),new t(13,new e(1,13)),new t(17,new e(1,9))),new i(2,[6,18],new t(10,new e(1,34)),new t(16,new e(1,28)),new t(22,new e(1,22)),new t(28,new e(1,16))),new i(3,[6,22],new t(15,new e(1,55)),new t(26,new e(1,44)),new t(18,new e(2,17)),new t(22,new e(2,13))),new i(4,[6,26],new t(20,new e(1,80)),new t(18,new e(2,32)),new t(26,new e(2,24)),new t(16,new e(4,9))),new i(5,[6,30],new t(26,new e(1,108)),new t(24,new e(2,43)),new t(18,new e(2,15),new e(2,16)),new t(22,new e(2,11),new e(2,12))),new i(6,[6,34],new t(18,new e(2,68)),new t(16,new e(4,27)),new t(24,new e(4,19)),new t(28,new e(4,15))),new i(7,[6,22,38],new t(20,new e(2,78)),new t(18,new e(4,31)),new t(18,new e(2,14),new e(4,15)),new t(26,new e(4,13),new e(1,14))),new i(8,[6,24,42],new t(24,new e(2,97)),new t(22,new e(2,38),new e(2,39)),new t(22,new e(4,18),new e(2,19)),new t(26,new e(4,14),new e(2,15))),new i(9,[6,26,46],new t(30,new e(2,116)),new t(22,new e(3,36),new e(2,37)),new t(20,new e(4,16),new e(4,17)),new t(24,new e(4,12),new e(4,13))),new i(10,[6,28,50],new t(18,new e(2,68),new e(2,69)),new t(26,new e(4,43),new e(1,44)),new t(24,new e(6,19),new e(2,20)),new t(28,new e(6,15),new e(2,16))),new i(11,[6,30,54],new t(20,new e(4,81)),new t(30,new e(1,50),new e(4,51)),new t(28,new e(4,22),new e(4,23)),new t(24,new e(3,12),new e(8,13))),new i(12,[6,32,58],new t(24,new e(2,92),new e(2,93)),new t(22,new e(6,36),new e(2,37)),new t(26,new e(4,20),new e(6,21)),new t(28,new e(7,14),new e(4,15))),new i(13,[6,34,62],new t(26,new e(4,107)),new t(22,new e(8,37),new e(1,38)),new t(24,new e(8,20),new e(4,21)),new t(22,new e(12,11),new e(4,12))),new i(14,[6,26,46,66],new t(30,new e(3,115),new e(1,116)),new t(24,new e(4,40),new e(5,41)),new t(20,new e(11,16),new e(5,17)),new t(24,new e(11,12),new e(5,13))),new i(15,[6,26,48,70],new t(22,new e(5,87),new e(1,88)),new t(24,new e(5,41),new e(5,42)),new t(30,new e(5,24),new e(7,25)),new t(24,new e(11,12),new e(7,13))),new i(16,[6,26,50,74],new t(24,new e(5,98),new e(1,99)),new t(28,new e(7,45),new e(3,46)),new t(24,new e(15,19),new e(2,20)),new t(30,new e(3,15),new e(13,16))),new i(17,[6,30,54,78],new t(28,new e(1,107),new e(5,108)),new t(28,new e(10,46),new e(1,47)),new t(28,new e(1,22),new e(15,23)),new t(28,new e(2,14),new e(17,15))),new i(18,[6,30,56,82],new t(30,new e(5,120),new e(1,121)),new t(26,new e(9,43),new e(4,44)),new t(28,new e(17,22),new e(1,23)),new t(28,new e(2,14),new e(19,15))),new i(19,[6,30,58,86],new t(28,new e(3,113),new e(4,114)),new t(26,new e(3,44),new e(11,45)),new t(26,new e(17,21),new e(4,22)),new t(26,new e(9,13),new e(16,14))),new i(20,[6,34,62,90],new t(28,new e(3,107),new e(5,108)),new t(26,new e(3,41),new e(13,42)),new t(30,new e(15,24),new e(5,25)),new t(28,new e(15,15),new e(10,16))),new i(21,[6,28,50,72,94],new t(28,new e(4,116),new e(4,117)),new t(26,new e(17,42)),new t(28,new e(17,22),new e(6,23)),new t(30,new e(19,16),new e(6,17))),new i(22,[6,26,50,74,98],new t(28,new e(2,111),new e(7,112)),new t(28,new e(17,46)),new t(30,new e(7,24),new e(16,25)),new t(24,new e(34,13))),new i(23,[6,30,54,74,102],new t(30,new e(4,121),new e(5,122)),new t(28,new e(4,47),new e(14,48)),new t(30,new e(11,24),new e(14,25)),new t(30,new e(16,15),new e(14,16))),new i(24,[6,28,54,80,106],new t(30,new e(6,117),new e(4,118)),new t(28,new e(6,45),new e(14,46)),new t(30,new e(11,24),new e(16,25)),new t(30,new e(30,16),new e(2,17))),new i(25,[6,32,58,84,110],new t(26,new e(8,106),new e(4,107)),new t(28,new e(8,47),new e(13,48)),new t(30,new e(7,24),new e(22,25)),new t(30,new e(22,15),new e(13,16))),new i(26,[6,30,58,86,114],new t(28,new e(10,114),new e(2,115)),new t(28,new e(19,46),new e(4,47)),new t(28,new e(28,22),new e(6,23)),new t(30,new e(33,16),new e(4,17))),new i(27,[6,34,62,90,118],new t(30,new e(8,122),new e(4,123)),new t(28,new e(22,45),new e(3,46)),new t(30,new e(8,23),new e(26,24)),new t(30,new e(12,15),new e(28,16))),new i(28,[6,26,50,74,98,122],new t(30,new e(3,117),new e(10,118)),new t(28,new e(3,45),new e(23,46)),new t(30,new e(4,24),new e(31,25)),new t(30,new e(11,15),new e(31,16))),new i(29,[6,30,54,78,102,126],new t(30,new e(7,116),new e(7,117)),new t(28,new e(21,45),new e(7,46)),new t(30,new e(1,23),new e(37,24)),new t(30,new e(19,15),new e(26,16))),new i(30,[6,26,52,78,104,130],new t(30,new e(5,115),new e(10,116)),new t(28,new e(19,47),new e(10,48)),new t(30,new e(15,24),new e(25,25)),new t(30,new e(23,15),new e(25,16))),new i(31,[6,30,56,82,108,134],new t(30,new e(13,115),new e(3,116)),new t(28,new e(2,46),new e(29,47)),new t(30,new e(42,24),new e(1,25)),new t(30,new e(23,15),new e(28,16))),new i(32,[6,34,60,86,112,138],new t(30,new e(17,115)),new t(28,new e(10,46),new e(23,47)),new t(30,new e(10,24),new e(35,25)),new t(30,new e(19,15),new e(35,16))),new i(33,[6,30,58,86,114,142],new t(30,new e(17,115),new e(1,116)),new t(28,new e(14,46),new e(21,47)),new t(30,new e(29,24),new e(19,25)),new t(30,new e(11,15),new e(46,16))),new i(34,[6,34,62,90,118,146],new t(30,new e(13,115),new e(6,116)),new t(28,new e(14,46),new e(23,47)),new t(30,new e(44,24),new e(7,25)),new t(30,new e(59,16),new e(1,17))),new i(35,[6,30,54,78,102,126,150],new t(30,new e(12,121),new e(7,122)),new t(28,new e(12,47),new e(26,48)),new t(30,new e(39,24),new e(14,25)),new t(30,new e(22,15),new e(41,16))),new i(36,[6,24,50,76,102,128,154],new t(30,new e(6,121),new e(14,122)),new t(28,new e(6,47),new e(34,48)),new t(30,new e(46,24),new e(10,25)),new t(30,new e(2,15),new e(64,16))),new i(37,[6,28,54,80,106,132,158],new t(30,new e(17,122),new e(4,123)),new t(28,new e(29,46),new e(14,47)),new t(30,new e(49,24),new e(10,25)),new t(30,new e(24,15),new e(46,16))),new i(38,[6,32,58,84,110,136,162],new t(30,new e(4,122),new e(18,123)),new t(28,new e(13,46),new e(32,47)),new t(30,new e(48,24),new e(14,25)),new t(30,new e(42,15),new e(32,16))),new i(39,[6,26,54,82,110,138,166],new t(30,new e(20,117),new e(4,118)),new t(28,new e(40,47),new e(7,48)),new t(30,new e(43,24),new e(22,25)),new t(30,new e(10,15),new e(67,16))),new i(40,[6,30,58,86,114,142,170],new t(30,new e(19,118),new e(6,119)),new t(28,new e(18,47),new e(31,48)),new t(30,new e(34,24),new e(34,25)),new t(30,new e(20,15),new e(61,16)))],i.getVersionForNumber=function(e){if(1>e||40<e)throw"ArgumentException";return i.VERSIONS[e-1]},i.getProvisionalVersionForDimension=function(e){if(1!=e%4)throw"Error getProvisionalVersionForDimension";try{return i.getVersionForNumber(e-17>>2)}catch(t){throw"Error getVersionForNumber"}},i.decodeVersionInformation=function(e){for(var t=4294967295,n=0,r=0;r<i.VERSION_DECODE_INFO.length;r++){var s=i.VERSION_DECODE_INFO[r];if(s==e)return this.getVersionForNumber(r+7);(s=o.numBitsDiffering(e,s))<t&&(n=r+7,t=s)}return 3>=t?this.getVersionForNumber(n):null},n.quadrilateralToQuadrilateral=function(e,t,i,n,r,s,o,a,h,_,f,w,u,d,l,c){return e=this.quadrilateralToSquare(e,t,i,n,r,s,o,a),this.squareToQuadrilateral(h,_,f,w,u,d,l,c).times(e)},n.squareToQuadrilateral=function(e,t,i,r,s,o,a,h){var _=h-o,f=t-r+o-h;if(0==_&&0==f)return new n(i-e,s-i,e,r-t,o-r,t,0,0,1);var w=i-s,u=a-s;s=e-i+s-a;var d=w*_-u*(o=r-o),_=(s*_-u*f)/d,f=(w*f-s*o)/d;return new n(i-e+_*i,a-e+f*a,e,r-t+_*r,h-t+f*h,t,_,f,1)},n.quadrilateralToSquare=function(e,t,i,n,r,s,o,a){return this.squareToQuadrilateral(e,t,i,n,r,s,o,a).buildAdjoint()};var C=[[21522,0],[20773,1],[24188,2],[23371,3],[17913,4],[16590,5],[20375,6],[19104,7],[30660,8],[29427,9],[32170,10],[30877,11],[26159,12],[25368,13],[27713,14],[26998,15],[5769,16],[5054,17],[7399,18],[6608,19],[1890,20],[597,21],[3340,22],[2107,23],[13663,24],[12392,25],[16177,26],[14854,27],[9396,28],[8579,29],[11994,30],[11245,31]],p=[0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4];o.numBitsDiffering=function(e,t){return p[15&(e^=t)]+p[15&d(e,4)]+p[15&d(e,8)]+p[15&d(e,12)]+p[15&d(e,16)]+p[15&d(e,20)]+p[15&d(e,24)]+p[15&d(e,28)]},o.decodeFormatInformation=function(e){var t=o.doDecodeFormatInformation(e);return null!=t?t:o.doDecodeFormatInformation(21522^e)},o.doDecodeFormatInformation=function(e){for(var t=4294967295,i=0,n=0;n<C.length;n++){var r=C[n],s=r[0];if(s==e)return new o(r[1]);(s=this.numBitsDiffering(e,s))<t&&(i=r[1],t=s)}return 3>=t?new o(i):null},a.forBits=function(e){if(0>e||e>=E.length)throw"ArgumentException";return E[e]};var k=new a(0,1,"L"),P=new a(1,0,"M"),B=new a(2,3,"Q"),S=new a(3,2,"H"),E=[P,k,S,B];_.getDataBlocks=function(e,t,i){if(e.length!=t.TotalCodewords)throw"ArgumentException";var n=t.getECBlocksForLevel(i);i=0;var r=n.getECBlocks();for(t=0;t<r.length;t++)i+=r[t].Count;i=Array(i);for(var s=0,o=0;o<r.length;o++){var a=r[o];for(t=0;t<a.Count;t++){var h=a.DataCodewords,f=n.ECCodewordsPerBlock+h;i[s++]=new _(h,Array(f))}}for(t=i[0].codewords.length,r=i.length-1;0<=r&&i[r].codewords.length!=t;)r--;for(r++,n=t-n.ECCodewordsPerBlock,t=a=0;t<n;t++)for(o=0;o<s;o++)i[o].codewords[t]=e[a++];for(o=r;o<s;o++)i[o].codewords[n]=e[a++];for(h=i[0].codewords.length,t=n;t<h;t++)for(o=0;o<s;o++)i[o].codewords[o<r?t:t+1]=e[a++];return i};var M={forReference:function(e){if(0>e||7<e)throw"System.ArgumentException";return M.DATA_MASKS[e]}};M.DATA_MASKS=[new function(){this.unmaskBitMatrix=function(e,t){for(var i=0;i<t;i++)for(var n=0;n<t;n++)this.isMasked(i,n)&&e.flip(n,i)},this.isMasked=function(e,t){return 0==(e+t&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var i=0;i<t;i++)for(var n=0;n<t;n++)this.isMasked(i,n)&&e.flip(n,i)},this.isMasked=function(e,t){return 0==(1&e)}},new function(){this.unmaskBitMatrix=function(e,t){for(var i=0;i<t;i++)for(var n=0;n<t;n++)this.isMasked(i,n)&&e.flip(n,i)},this.isMasked=function(e,t){return 0==t%3}},new function(){this.unmaskBitMatrix=function(e,t){for(var i=0;i<t;i++)for(var n=0;n<t;n++)this.isMasked(i,n)&&e.flip(n,i)},this.isMasked=function(e,t){return 0==(e+t)%3}},new function(){this.unmaskBitMatrix=function(e,t){for(var i=0;i<t;i++)for(var n=0;n<t;n++)this.isMasked(i,n)&&e.flip(n,i)},this.isMasked=function(e,t){return 0==(d(e,1)+t/3&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var i=0;i<t;i++)for(var n=0;n<t;n++)this.isMasked(i,n)&&e.flip(n,i)},this.isMasked=function(e,t){var i=e*t;return 0==(1&i)+i%3}},new function(){this.unmaskBitMatrix=function(e,t){for(var i=0;i<t;i++)for(var n=0;n<t;n++)this.isMasked(i,n)&&e.flip(n,i)},this.isMasked=function(e,t){var i=e*t;return 0==((1&i)+i%3&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var i=0;i<t;i++)for(var n=0;n<t;n++)this.isMasked(i,n)&&e.flip(n,i)},this.isMasked=function(e,t){return 0==((e+t&1)+e*t%3&1)}}],u.QR_CODE_FIELD=new u(285),u.DATA_MATRIX_FIELD=new u(301),u.addOrSubtract=function(e,t){return e^t};var y={};y.rsDecoder=new function(e){this.field=e,this.decode=function(e,t){for(var i=new w(this.field,e),n=Array(t),r=0;r<n.length;r++)n[r]=0;for(var s=!0,r=0;r<t;r++){var o=i.evaluateAt(this.field.exp(r));n[n.length-1-r]=o,0!=o&&(s=!1)}if(!s)for(r=new w(this.field,n),r=(i=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),r,t))[1],i=this.findErrorLocations(i[0]),n=this.findErrorMagnitudes(r,i,!1),r=0;r<i.length;r++){if(0>(s=e.length-1-this.field.log(i[r])))throw"ReedSolomonException Bad error location";e[s]=u.addOrSubtract(e[s],n[r])}},this.runEuclideanAlgorithm=function(e,t,i){if(e.Degree<t.Degree){var n=e;e=t,t=n}for(var n=this.field.One,r=this.field.Zero,s=this.field.Zero,o=this.field.One;t.Degree>=Math.floor(i/2);){var a=e,h=n,_=s;if(e=t,n=r,s=o,e.Zero)throw"r_{i-1} was zero";for(t=a,o=this.field.Zero,r=e.getCoefficient(e.Degree),r=this.field.inverse(r);t.Degree>=e.Degree&&!t.Zero;){var a=t.Degree-e.Degree,f=this.field.multiply(t.getCoefficient(t.Degree),r),o=o.addOrSubtract(this.field.buildMonomial(a,f));t=t.addOrSubtract(e.multiplyByMonomial(a,f))}r=o.multiply1(n).addOrSubtract(h),o=o.multiply1(s).addOrSubtract(_)}if(0==(i=o.getCoefficient(0)))throw"ReedSolomonException sigmaTilde(0) was zero";return i=this.field.inverse(i),[e=o.multiply2(i),i=t.multiply2(i)]},this.findErrorLocations=function(e){var t=e.Degree;if(1==t)return Array(e.getCoefficient(1));for(var i=Array(t),n=0,r=1;256>r&&n<t;r++)0==e.evaluateAt(r)&&(i[n]=this.field.inverse(r),n++);if(n!=t)throw"Error locator degree does not match number of roots";return i},this.findErrorMagnitudes=function(e,t,i){for(var n=t.length,r=Array(n),s=0;s<n;s++){for(var o=this.field.inverse(t[s]),a=1,h=0;h<n;h++)s!=h&&(a=this.field.multiply(a,u.addOrSubtract(1,this.field.multiply(t[h],o))));r[s]=this.field.multiply(e.evaluateAt(o),this.field.inverse(a)),i&&(r[s]=this.field.multiply(r[s],o))}return r}}(u.QR_CODE_FIELD),y.correctErrors=function(e,t){for(var i=e.length,n=Array(i),r=0;r<i;r++)n[r]=255&e[r];i=e.length-t;try{y.rsDecoder.decode(n,i)}catch(s){throw s}for(r=0;r<t;r++)e[r]=n[r]},y.decode=function(e){var t=new f(e);e=t.readVersion();for(var i=t.readFormatInformation().ErrorCorrectionLevel,t=t.readCodewords(),t=_.getDataBlocks(t,e,i),n=0,r=0;r<t.length;r++)n+=t[r].NumDataCodewords;for(var n=Array(n),s=0,o=0;o<t.length;o++){var r=t[o],a=r.Codewords,h=r.NumDataCodewords;for(y.correctErrors(a,h),r=0;r<h;r++)n[s++]=a[r]}return new v(n,e.VersionNumber,i.Bits)};var D={imagedata:null,width:0,height:0,qrCodeSymbol:null,debug:!1,maxImgSize:1048576,sizeOfDataLengthInfo:[[10,9,8,8],[12,11,16,10],[14,13,16,12]],callback:null,vidSuccess:function(e){D.localstream=e,D.webkit?D.video.src=window.webkitURL.createObjectURL(e):D.moz?(D.video.mozSrcObject=e,D.video.play()):D.video.src=e,D.gUM=!0,D.canvas_qr2=document.createElement("canvas"),D.canvas_qr2.id="qr-canvas",D.qrcontext2=D.canvas_qr2.getContext("2d"),D.canvas_qr2.width=D.video.videoWidth,D.canvas_qr2.height=D.video.videoHeight,setTimeout(D.captureToCanvas,500)},vidError:function(e){D.gUM=!1},captureToCanvas:function(){if(D.gUM)try{if(0==D.video.videoWidth)setTimeout(D.captureToCanvas,500);else{D.canvas_qr2.width=D.video.videoWidth,D.canvas_qr2.height=D.video.videoHeight,D.qrcontext2.drawImage(D.video,0,0);try{D.decode()}catch(e){console.log(e),setTimeout(D.captureToCanvas,500)}}}catch(t){console.log(t),setTimeout(D.captureToCanvas,500)}},setWebcam:function(e){var t=navigator;D.video=document.getElementsByTagName("qr-reader")[0].shadowRoot.getElementById(e);var i=!0;if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)try{navigator.mediaDevices.enumerateDevices().then(function(e){e.forEach(function(e){console.log("deb1"),"videoinput"===e.kind&&-1<e.label.toLowerCase().search("back")&&(i=[{sourceId:e.deviceId}]),console.log(e.kind+": "+e.label+" id = "+e.deviceId)})})}catch(n){console.log(n)}else console.log("no navigator.mediaDevices.enumerateDevices");t.getUserMedia?t.getUserMedia({video:i,audio:!1},D.vidSuccess,D.vidError):t.webkitGetUserMedia?(D.webkit=!0,t.webkitGetUserMedia({video:i,audio:!1},D.vidSuccess,D.vidError)):t.mozGetUserMedia&&(D.moz=!0,t.mozGetUserMedia({video:i,audio:!1},D.vidSuccess,D.vidError))},decode:function(e){if(0==arguments.length){if(D.canvas_qr2)var t=D.canvas_qr2,i=D.qrcontext2;else i=(t=document.getElementsByTagName("qr-reader")[0].shadowRoot.getElementById("qr-canvas")).getContext("2d");return D.width=t.width,D.height=t.height,D.imagedata=i.getImageData(0,0,D.width,D.height),D.result=D.process(i),null!=D.callback&&D.callback(D.result),D.result}var n=new Image;n.crossOrigin="Anonymous",n.onload=function(){var e=document.getElementsByTagName("qr-reader")[0].shadowRoot.getElementById("out-canvas");null!=e&&((e=e.getContext("2d")).clearRect(0,0,320,240),e.drawImage(n,0,0,320,240));var e=document.createElement("canvas"),t=e.getContext("2d"),i=n.height,r=n.width;n.width*n.height>D.maxImgSize&&(r=n.width/n.height,i=Math.sqrt(D.maxImgSize/r),r*=i),e.width=r,e.height=i,t.drawImage(n,0,0,e.width,e.height),D.width=e.width,D.height=e.height;try{D.imagedata=t.getImageData(0,0,e.width,e.height)}catch(s){D.result=Error("Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!"),null!=D.callback&&D.callback(D.result);return}try{D.result=D.process(t)}catch(o){console.log(o),D.result=Error("error decoding QR Code")}null!=D.callback&&D.callback(D.result)},n.onerror=function(){null!=D.callback&&D.callback(Error("Failed to load the image"))},n.src=e},isUrl:function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)},decode_url:function(e){var t="";try{t=escape(e)}catch(i){console.log(i),t=e}e="";try{e=decodeURIComponent(t)}catch(n){console.log(n),e=t}return e},decode_utf8:function(e){return D.isUrl(e)?D.decode_url(e):e},process:function(e){(new Date).getTime();var t=D.grayScaleToBitmap(D.grayscale());if(D.debug){for(var i=0;i<D.height;i++)for(var n=0;n<D.width;n++){var r=4*n+i*D.width*4;D.imagedata.data[r]=0,D.imagedata.data[r+1]=0,D.imagedata.data[r+2]=t[n+i*D.width]?255:0}e.putImageData(D.imagedata,0,0)}if(t=new s(t).detect(),D.debug){for(i=0;i<t.bits.Height;i++)for(n=0;n<t.bits.Width;n++)r=8*n+2*i*D.width*4,D.imagedata.data[r]=(t.bits.get_Renamed(n,i),0),D.imagedata.data[r+1]=(t.bits.get_Renamed(n,i),0),D.imagedata.data[r+2]=t.bits.get_Renamed(n,i)?255:0;e.putImageData(D.imagedata,0,0)}for(i=0,r=y.decode(t.bits).DataByte,e="";i<r.length;i++)for(n=0;n<r[i].length;n++)e+=String.fromCharCode(r[i][n]);return r=(new Date).getTime(),D.decode_utf8(e)},getPixel:function(e,t){if(D.width<e||D.height<t)throw"point error";var i=4*e+t*D.width*4;return(33*D.imagedata.data[i]+34*D.imagedata.data[i+1]+33*D.imagedata.data[i+2])/100},binarize:function(e){for(var t=Array(D.width*D.height),i=0;i<D.height;i++)for(var n=0;n<D.width;n++){var r=D.getPixel(n,i);t[n+i*D.width]=r<=e}return t},getMiddleBrightnessPerArea:function(e){for(var t=Math.floor(D.width/4),i=Math.floor(D.height/4),n=[,,,,],r=0;4>r;r++){n[r]=[,,,,];for(var s=0;4>s;s++)n[r][s]=[0,0]}for(r=0;4>r;r++)for(s=0;4>s;s++){n[s][r][0]=255;for(var o=0;o<i;o++)for(var a=0;a<t;a++){var h=e[t*s+a+(i*r+o)*D.width];h<n[s][r][0]&&(n[s][r][0]=h),h>n[s][r][1]&&(n[s][r][1]=h)}}for(t=0,e=[,,,,];4>t;t++)e[t]=[,,,,];for(r=0;4>r;r++)for(s=0;4>s;s++)e[s][r]=Math.floor((n[s][r][0]+n[s][r][1])/2);return e},grayScaleToBitmap:function(e){for(var t=D.getMiddleBrightnessPerArea(e),i=t.length,n=Math.floor(D.width/i),r=Math.floor(D.height/i),s=new ArrayBuffer(D.width*D.height),s=new Uint8Array(s),o=0;o<i;o++)for(var a=0;a<i;a++)for(var h=0;h<r;h++)for(var _=0;_<n;_++)s[n*a+_+(r*o+h)*D.width]=e[n*a+_+(r*o+h)*D.width]<t[a][o];return s},grayscale:function(){for(var e=new ArrayBuffer(D.width*D.height),e=new Uint8Array(e),t=0;t<D.height;t++)for(var i=0;i<D.width;i++){var n=D.getPixel(i,t);e[i+t*D.width]=n}return e}},x=3,F=57,I=8,R=2;return D.orderBestPatterns=function(e){function t(e,t){var i=e.X-t.X,n=e.Y-t.Y;return Math.sqrt(i*i+n*n)}var i,n,r,s,o=t(e[0],e[1]),a=t(e[1],e[2]),h=t(e[0],e[2]);if(a>=o&&a>=h?(a=e[0],o=e[1],h=e[2]):h>=a&&h>=o?(a=e[1],o=e[0],h=e[2]):(a=e[2],o=e[0],h=e[1]),0>(i=o,n=a,r=h,s=n.x,n=n.y,(r.x-s)*(i.y-n)-(r.y-n)*(i.x-s)))var _=o,o=h,h=_;e[0]=o,e[1]=a,e[2]=h},D}();